---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';

// Importar imágenes para fondo aleatorio
const allImages = import.meta.glob('/src/assets/**/*.{jpg,jpeg,png,webp}', { eager: true });
const imageUrls = Object.values(allImages).map((img: any) => img.default.src);
const randomBg = imageUrls[Math.floor(Math.random() * imageUrls.length)];

// Exposiciones actuales (dos muestras simultáneas)
const exposiciones = {
    lugar: "Hotel Palacio de Merás",
    ubicacion: "Tineo, Asturias",
    fecha: "Hasta final del año 2025",
    videoId: "-RwfYSBFenc",
};

const vacuo = {
    titulo: "Vacuo",
    artista: "Lucas Santiago",
    descripcion: `Una exposición donde Lucas Santiago rescata objetos olvidados de pueblos abandonados para transformarlos en piezas de joyería contemporánea. Esta muestra invita a reflexionar sobre el vacío que dejan los lugares que un día fueron hogar.

A través de materiales como maderas, huesos, piedras y cuernos —todos ellos marcados por el paso del tiempo—, Santiago devuelve la vida a estos objetos, convirtiéndolos en joyas que guardan la memoria de quienes los usaron. El título "Vacuo" hace referencia a ese silencio de las aldeas abandonadas, espacios que aún conservan secretos y vivencias de sus antiguos habitantes.

"La reserva espiritual de nuestra sociedad está en los pueblos", reflexiona el artista. Esta exposición es un ejercicio de memoria colectiva, una forma de evitar que el folclore y la cultura rural caigan en el olvido.`
};
---

<Layout title="Lucas Santiago - Joyería Rural Contemporánea">
    <Navbar />

    {/* Fondo decorativo */}
    <div class="fixed inset-0 z-0 pointer-events-none">
        <div
            class="absolute inset-0 bg-cover bg-center opacity-5"
            style={`background-image: url('${randomBg}');`}
        ></div>
    </div>

    <main class="relative z-10 pt-24 px-4 sm:px-8 max-w-6xl mx-auto pb-16">
        {/* Hero compacto */}
        <section class="mb-10 text-center py-6">
            <h1 class="text-lg md:text-xl uppercase tracking-widest text-stone-700 mb-8" style="font-family: 'Oswald', sans-serif;">
                Exposición actual
            </h1>

            {/* Dos exposiciones en grid simétrico */}
            <div class="grid md:grid-cols-2 gap-6 max-w-3xl mx-auto mb-6">
                <div class="text-center md:text-right p-4">
                    <h2 class="text-3xl md:text-4xl font-light uppercase tracking-widest mb-2" style="font-family: 'Oswald', sans-serif; color: #9D7748;">
                        {vacuo.titulo}
                    </h2>
                    <p class="text-sm text-stone-500 font-light">{vacuo.artista}</p>
                </div>

                <div class="text-center md:text-left p-4 md:border-l border-stone-200">
                    <h2 class="text-3xl md:text-4xl font-light uppercase tracking-widest text-stone-700 mb-2" style="font-family: 'Oswald', sans-serif;">
                        A fuego y martillo
                    </h2>
                    <p class="text-sm text-stone-500 font-light">César Castaño</p>
                </div>
            </div>

            <p class="text-stone-500 font-light text-sm">
                {exposiciones.lugar} · {exposiciones.ubicacion} · {exposiciones.fecha}
            </p>
        </section>

        {/* Grid: Vídeo + Descripción */}
        <section class="mb-10">
            <div class="grid lg:grid-cols-2 gap-8 items-start">
                {/* Vídeo */}
                <div class="video-container aspect-video w-full" data-video-id={exposiciones.videoId}>
                    <img
                        src={`https://img.youtube.com/vi/${exposiciones.videoId}/maxresdefault.jpg`}
                        alt="Vídeo de la exposición Vacuo"
                        class="video-thumbnail"
                        loading="lazy"
                    />
                    <button class="play-button" aria-label="Reproducir vídeo">
                        <svg viewBox="0 0 68 48" width="68" height="48">
                            <path d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z" fill="#212121" fill-opacity="0.8"></path>
                            <path d="M 45,24 27,14 27,34" fill="#fff"></path>
                        </svg>
                    </button>
                </div>

                {/* Descripción */}
                <div class="text-stone-700 font-light leading-relaxed text-sm md:text-base">
                    {vacuo.descripcion.split('\n\n').map((parrafo) => (
                        <p class="mb-4 last:mb-0">{parrafo}</p>
                    ))}
                </div>
            </div>
        </section>

        {/* CTA */}
        <section class="text-center py-6 border-t border-stone-200">
            <a
                href="/contacto"
                class="cta-btn inline-block px-6 py-2 text-sm uppercase tracking-widest font-light transition-all duration-300"
            >
                Contactar
            </a>
        </section>
    </main>
</Layout>

<style>
    .cta-btn {
        border: 2px solid #9D7748;
        color: #9D7748;
    }

    .cta-btn:hover {
        background-color: #9D7748;
        color: white;
        border-color: #9D7748;
    }

    .video-container {
        position: relative;
        cursor: pointer;
        overflow: hidden;
        background-color: #000;
    }

    .video-thumbnail {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: opacity 0.3s;
    }

    .video-container:hover .video-thumbnail {
        opacity: 0.85;
    }

    .play-button {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: none;
        border: none;
        cursor: pointer;
        transition: transform 0.2s, opacity 0.2s;
        opacity: 0.9;
    }

    .video-container:hover .play-button {
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 1;
    }

    .play-button svg path:first-child {
        transition: fill-opacity 0.2s;
    }

    .video-container:hover .play-button svg path:first-child {
        fill: #9D7748;
        fill-opacity: 1;
    }

    .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100% !important;
        height: 100% !important;
        border: none;
        z-index: 10;
    }

    .video-container.playing {
        background-color: #000;
    }

    .video-container.playing .video-thumbnail,
    .video-container.playing .play-button {
        display: none;
    }

    /* Asegurar que aspect-video funciona con el iframe */
    .video-container.aspect-video {
        position: relative;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const videoContainers = document.querySelectorAll('.video-container');

        videoContainers.forEach(container => {
            container.addEventListener('click', () => {
                const videoId = container.getAttribute('data-video-id');
                if (!videoId) return;

                const iframe = document.createElement('iframe');
                // Parámetros para minimizar elementos de YouTube
                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1&showinfo=0&iv_load_policy=3&controls=1`;
                iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
                iframe.allowFullscreen = true;
                iframe.style.cssText = 'position:absolute;top:0;left:0;width:100%;height:100%;border:none;';

                // Ocultar thumbnail y botón, añadir iframe
                const thumbnail = container.querySelector('.video-thumbnail');
                const playBtn = container.querySelector('.play-button');
                if (thumbnail) thumbnail.style.display = 'none';
                if (playBtn) playBtn.style.display = 'none';

                container.appendChild(iframe);
                container.style.cursor = 'default';
            });
        });
    });
</script>
